#include QMK_KEYBOARD_H

static const char PROGMEM keyball_logo[] = {
// 'keyball_logo44', 32x16px
0x70, 0x48, 0x48, 0x7e, 0x3b, 0x1d, 0x1f, 0x0e, 0x00, 0x7e, 0x30, 0x4e, 0x00, 0x7c, 0x54, 0x5c,
0x00, 0x5c, 0x50, 0x7c, 0x00, 0x7c, 0x50, 0x70, 0x00, 0x74, 0x54, 0x7c, 0x00, 0x7e, 0x00, 0x7e,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1f, 0x1f, 0x10, 0x10, 0xff, 0xff, 0x00,
0x1f, 0x1f, 0x10, 0x10, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};


static const char PROGMEM ori_over[] = {
// 'ori_over', 32x11px
0x70, 0x70, 0x70, 0xf0, 0xf0, 0xf0, 0x70, 0x70, 0x70, 0x70, 0x70, 0x00, 0xff, 0xc7, 0x83, 0x01,
0x01, 0x83, 0xc7, 0xff, 0x00, 0x70, 0x70, 0x70, 0x70, 0x70, 0xf0, 0xf0, 0xf0, 0x70, 0x70, 0x70,
0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0x05, 0x04, 0x04,
0x04, 0x04, 0x05, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x00, 0x00, 0x00
};

static const char PROGMEM ori_under[] = {
// 'ori_under', 32x6px
0x38, 0x38, 0x38, 0x3f, 0x3f, 0x3f, 0x38, 0x38, 0x38, 0x38, 0x38, 0x38, 0x38, 0x38, 0x38, 0x38,
0x38, 0x38, 0x38, 0x38, 0x38, 0x38, 0x38, 0x38, 0x38, 0x38, 0x3f, 0x3f, 0x3f, 0x38, 0x38, 0x38
};

// 'agumon', 36x36px
static const char PROGMEM agumon0[] = {
// '32agubmon_taiki1', 32x32px
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 0xc0, 0xf0, 0xf0, 0x0c, 0x0c, 0xcc, 0xcc, 0xcc,
0xcc, 0x0c, 0x0c, 0x0c, 0x0c, 0x30, 0x30, 0xc0, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x3c, 0x3c, 0xf3, 0xf3, 0x33, 0x33, 0x30, 0x30, 0x00, 0x00, 0x00, 0x00, 0x0c, 0x0c, 0x0f,
0x0f, 0x0f, 0x0f, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0xfc, 0xfc, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0xf3, 0xf3, 0xcf, 0xcf, 0xff, 0xff, 0x03, 0x03, 0x03, 0x03, 0xf0,
0xf0, 0xcc, 0xcc, 0xc0, 0xc0, 0xc0, 0xc0, 0x0f, 0x0f, 0xf0, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0xf0, 0xf0, 0xcc, 0xcc, 0xfc, 0xfc, 0xc3, 0xc3, 0xc3, 0xc3, 0xfc, 0xfc, 0x0c,
0x0c, 0xfc, 0xfc, 0xcc, 0xcc, 0xf3, 0xf3, 0xc0, 0xc0, 0xf0, 0xf0, 0xcf, 0xcf, 0xf0, 0xf0, 0x00,
};

static const char PROGMEM agumon1[] = {
// '32agubmon_taiki2', 32x32px
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 0xc0, 0x30, 0x30, 0x30, 0x30, 0x30,
0x30, 0x30, 0x30, 0x30, 0x30, 0xc0, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0xf0, 0xf0, 0xcc, 0xcc, 0xcc, 0xcc, 0xc3, 0xc3, 0x03, 0x03, 0x00, 0x00, 0x33, 0x33, 0x3f,
0x3f, 0x3c, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x0f, 0x0f, 0xf0, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x03, 0x03, 0xcc, 0xcc, 0x3c, 0x3c, 0xfc, 0xfc, 0x0c, 0x0c, 0x0c, 0x0c, 0x00,
0x00, 0xc0, 0xc0, 0x30, 0x30, 0x00, 0x00, 0x3c, 0x3c, 0xc3, 0xc3, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0xf0, 0xf0, 0xcf, 0xcf, 0xfc, 0xfc, 0xcf, 0xcf, 0xcc, 0xcc, 0xf0, 0xf0, 0x30,
0x30, 0xf3, 0xf3, 0xcc, 0xcc, 0xf3, 0xf3, 0xc0, 0xc0, 0xf3, 0xf3, 0xcc, 0xcc, 0xf0, 0xf0, 0x00,
};

static const char PROGMEM agumon2[] = {
// '32agumon_eat', 32x32px
0x00, 0x30, 0x30, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0x0c, 0x0c, 0x03, 0x03, 0x33, 0x33, 0xf3,
0xf3, 0xc3, 0xc3, 0x03, 0x03, 0x0c, 0x0c, 0xf0, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0xc0, 0xc0, 0x30, 0x30, 0x30, 0x30, 0x3f, 0x3f, 0x00, 0x00, 0x03, 0x03, 0x03,
0x03, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0xf3, 0xf3, 0xcf, 0xcf, 0xff, 0xff, 0x03, 0x03, 0x03, 0x03, 0xf0,
0xf0, 0xcc, 0xcc, 0xc0, 0xc0, 0xc0, 0xc0, 0x0f, 0x0f, 0xf0, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0xf0, 0xf0, 0xcc, 0xcc, 0xfc, 0xfc, 0xc3, 0xc3, 0xc3, 0xc3, 0xfc, 0xfc, 0x0c,
0x0c, 0xfc, 0xfc, 0xcc, 0xcc, 0xf3, 0xf3, 0xc0, 0xc0, 0xf0, 0xf0, 0xcf, 0xcf, 0xf0, 0xf0, 0x00
};

static const char PROGMEM agumon_rev0[] = {
// '32agubmon_taiki1', 32x32px
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 0xc0, 0x30, 0x30, 0x0c, 0x0c, 0x0c, 0x0c, 0xcc,
0xcc, 0xcc, 0xcc, 0x0c, 0x0c, 0xf0, 0xf0, 0xc0, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0xfc, 0xfc, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x0f, 0x0f, 0x0f,
0x0f, 0x0c, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x30, 0x30, 0x33, 0x33, 0xf3, 0xf3, 0x3c, 0x3c, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0xf0, 0xf0, 0x0f, 0x0f, 0xc0, 0xc0, 0xc0, 0xc0, 0xcc, 0xcc, 0xf0,
0xf0, 0x03, 0x03, 0x03, 0x03, 0xff, 0xff, 0xcf, 0xcf, 0xf3, 0xf3, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0xf0, 0xf0, 0xcf, 0xcf, 0xf0, 0xf0, 0xc0, 0xc0, 0xf3, 0xf3, 0xcc, 0xcc, 0xfc, 0xfc, 0x0c,
0x0c, 0xfc, 0xfc, 0xc3, 0xc3, 0xc3, 0xc3, 0xfc, 0xfc, 0xcc, 0xcc, 0xf0, 0xf0, 0x00, 0x00, 0x00,
};

static const char PROGMEM agumon_rev1[] = {
// '32agubmon_taiki2', 32x32px
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 0xc0, 0x30, 0x30, 0x30, 0x30, 0x30,
0x30, 0x30, 0x30, 0x30, 0x30, 0xc0, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0xf0, 0xf0, 0x0f, 0x0f, 0x00, 0x00, 0x00, 0x00, 0x3c, 0x3c, 0x3f,
0x3f, 0x33, 0x33, 0x00, 0x00, 0x03, 0x03, 0xc3, 0xc3, 0xcc, 0xcc, 0xcc, 0xcc, 0xf0, 0xf0, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0xc3, 0xc3, 0x3c, 0x3c, 0x00, 0x00, 0x30, 0x30, 0xc0, 0xc0, 0x00,
0x00, 0x0c, 0x0c, 0x0c, 0x0c, 0xfc, 0xfc, 0x3c, 0x3c, 0xcc, 0xcc, 0x03, 0x03, 0x00, 0x00, 0x00,
0x00, 0xf0, 0xf0, 0xcc, 0xcc, 0xf3, 0xf3, 0xc0, 0xc0, 0xf3, 0xf3, 0xcc, 0xcc, 0xf3, 0xf3, 0x30,
0x30, 0xf0, 0xf0, 0xcc, 0xcc, 0xcf, 0xcf, 0xfc, 0xfc, 0xcf, 0xcf, 0xf0, 0xf0, 0x00, 0x00, 0x00,
};

static const char PROGMEM agumon_rev2[] = {
// '32agumon_eat', 32x32px
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xf0, 0xf0, 0x0c, 0x0c, 0x03, 0x03, 0xc3, 0xc3, 0xf3,
0xf3, 0x33, 0x33, 0x03, 0x03, 0x0c, 0x0c, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0x30, 0x30, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03,
0x03, 0x03, 0x03, 0x00, 0x00, 0x3f, 0x3f, 0x30, 0x30, 0x30, 0x30, 0xc0, 0xc0, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0xf0, 0xf0, 0x0f, 0x0f, 0xc0, 0xc0, 0xc0, 0xc0, 0xcc, 0xcc, 0xf0,
0xf0, 0x03, 0x03, 0x03, 0x03, 0xff, 0xff, 0xcf, 0xcf, 0xf3, 0xf3, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0xf0, 0xf0, 0xcf, 0xcf, 0xf0, 0xf0, 0xc0, 0xc0, 0xf3, 0xf3, 0xcc, 0xcc, 0xfc, 0xfc, 0x0c,
0x0c, 0xfc, 0xfc, 0xc3, 0xc3, 0xc3, 0xc3, 0xfc, 0xfc, 0xcc, 0xcc, 0xf0, 0xf0, 0x00, 0x00, 0x00
};



#include "timer.h"

// アニメフレーム数
#define FRAME_COUNT 56

// フレームごとの画像
static const char *const anime_frames[FRAME_COUNT] =
{
    agumon0, agumon1,agumon0, agumon1,agumon0, agumon1,agumon0, agumon1,
    agumon_rev0, agumon_rev1,agumon_rev0, agumon_rev1,agumon_rev0, agumon_rev1,agumon_rev0,
    agumon0, agumon1,agumon0, agumon1,agumon0, agumon1,agumon0,
    agumon1, agumon2,agumon1, agumon2,agumon1, agumon2,
    agumon_rev0, agumon_rev1,agumon_rev0, agumon_rev1,agumon_rev0, agumon_rev1,agumon_rev0, agumon_rev1,
    agumon0, agumon1,agumon0, agumon1,agumon0, agumon1,agumon0,
    agumon_rev0, agumon_rev1,agumon_rev0, agumon_rev1,agumon_rev0, agumon_rev1,agumon_rev0,
    agumon_rev1, agumon_rev2,agumon_rev1, agumon_rev2,agumon_rev1, agumon_rev2
};

// 現在のフレーム
static uint8_t current_frame = 0;

// 最後のフレームを更新した時刻
static uint16_t last_frame_update_time = 0;

// フレームの更新間隔
#define FRAME_INTERVAL 800

// アニメを表示する関数
static void render_agumon(void) {
    // 現在の時刻を取得
    uint16_t current_time = timer_read();

    // 設定時間経過していたら次のフレームに進む
    if (timer_elapsed(last_frame_update_time) > FRAME_INTERVAL) {
        current_frame = (current_frame + 1) % FRAME_COUNT; // フレームを次に進める
        last_frame_update_time = current_time; // 最後の更新時刻を現在の時刻に設定
    }

    uint8_t frame0 = current_frame;
    // uint8_t frame1 = (current_frame + 1) % FRAME_COUNT;

    oled_set_cursor(0, 8);  // 画像表示する位置
    oled_write_raw_P(anime_frames[frame0], sizeof(agumon0));

}

// 檻画像表示
static void render_ori(void){
    oled_set_cursor(0, 5);
    oled_write_raw_P(ori_over, sizeof(ori_over));

    oled_set_cursor(0,13);
    oled_write_raw_P(ori_under, sizeof(ori_under));
};

// keyballロゴ画像表示
static void render_keyball_logo(void){
    oled_set_cursor(0, 2);
    oled_write_raw_P(keyball_logo, sizeof(keyball_logo));
};

// OLEDメイン処理(サブ側)
void keyball_oled_render_mysub(void) {
    render_keyball_logo();
    render_ori();
    render_agumon();
}
